= Test-Plan

Dieser Testplan stellt eine vereinfachte Version der IEEE 829-1998 Vorlage dar.

== Einführung
Der Testplan wird erstellt, um den Testprozess unserer Anwendung zu beschreiben und folgende Aspekte zu klären:

- die Auswahl der richtigen Strategien für verschiedene Tests von Software-Komponenten
- Verteilung der Aufgaben zwischen den Teammitgliedern
- Priorität der Fragen
- Ressourcenplanung
- die Nutzung der erforderlichen Software und Hardware
- Abschätzung der Risiken, die während der Prüfung auftreten können.

== Aufbau der Testbezeichner

U = Unit Test:

- prüft Einzelteile eines Computerprogrammes auf Funktionalität

I = Integrationstest:

- eine Reihe von aufeinander abgestimmten Einzeltests, die dazu dienen, verschiedene voneinander abhängige Komponenten eines komplexen Systems im Zusammenspiel miteinander zu testen
- die einzelnen Komponenten sollten einen Unit-Test bestanden haben

zum Beispiel: U1, U2, I1

== Test Gegenstände
Die gesamte Anwendung von McTank bestehend aus 

- McZapf 
- McWash 
- McSit 
- McDrive 
- registrierter Kunde 
- nicht registrierter Kunde 
- Manager 
- Mitarbeiter 
- Catalog 
- Inventory 
- Order 


== Zu testende Funktionalitäten
- <<MainControllerTest>>
- <<RefillInventoryControllerTest>>
- <<UserManagementControllerTest>>
- <<ItemsControllerTest>>
- <<CustomerUnitTest>>
- <<DiscountUnitTest>>
- <<GasPumpUnitTest>>
- <<McProductUnitTest>>
- <<McSitReservationUnitTest>>

== Nicht zu testende Funktionalitäten
z.B. Bibliotheken von Drittanbietern (eigene Tests beschränken sich auf Schnittstelle, bzw. Zusammenspiel).

- Daten der Zapfsäulen
- gegebene Bibliotheken oder Frameworks

== Herangehensweise
Die Units bzw. Klassen werden mit JUnit getestet.
Die Testfälle werden vor dem Code entwickelt, damit nur Dinge implementiert werden, die auch getestet werden können, um somit Fehler beim Programmieren zu vermeiden.

1. Testfälle ausdenken / Testfalltabellen erstellen
- Bestimme die Extremwerte der Parameter der zu testenden Methode (Grenzwertanalyse, Nullwerte immer testen, z.B. 0 oder null, Randwerte z.B. 1.1. und 31.12.)
- Bestimme Bereichseinschränkungen (Werte außerhalb eines Zahlenbereiches, Negative Werte, wenn natürliche Zahlen im Spiel sind)
- Bestimme Zustände, in denen sich ein Objekt nach einer Anweisung befinden muss
2. Testfälle in Klassen gruppieren
3. pro Testfall eine Testmethode schreiben
4. Testfälle (nach Änderungen im Programm wiederholt) ausführen = Regressionstest

== Umgebungsvoraussetzungen
* Wird spezielle Hardware benötigt?

- keine spezielle Hardware, die Tests werden mit in das eigentliche Programm integriert
* Welche Daten müssen bereitgestellt werden? Wie werden die Daten bereitgestellt?
- es wird ein automatisch wiederholbarer JUnit-Test geschrieben und dann der zu testende Code. Der Test ist selbst ein Stück Software und wird ebenso wie der zu testende Code programmiert.
* Wird zusätzliche Software für das Testen benötigt?

- jUnit

* Wie kommuniziert die Software während des Testens? Internet? Netzwerk?
- 

== Testfälle und Verantwortlichkeit
Jede testbezogene Aufgabe muss einem Ansprechpartner zugeordnet werden.

== MainControllerTest
// See http://asciidoctor.org/docs/user-manual/#tables
[options="headers"]
|===
|ID   |Anwendungsfall |Vorbedingungen |Eingabe |Ausgabe
||HTML-Seitenaufruf            |Eine Seite wird von einem User aufgerufen| mockMvc.perform(get("/"))     |.andExpect(status().isFound())
||Login-Aufruf           | Falls ein nicht eingeloggter User auf die Anwendung zugreifen will, wird er auf die Login-Page geleitet             |mockMvc.perform(get("/")) |.andExpect(status().isFound()).andExpect(redirectedUrl("/login")
||Admin-Startseite | Ein User loggt sich als Admin auf der Website ein             |mockMvc.perform(get("/")) |.andExpect(status().isFound()).andExpect(redirectedUrl("/overview")
|| Mitarbeiter-Startseite          |Ein User loggt sich als Mitarbeiter auf der Website ein              |mockMvc.perform(get("/")) |.andExpect(status().isFound()).andExpect(redirectedUrl("/cart"))
|| Customer-Startseite          | Ein User loggt sich als Kunde auf der Website ein             |mockMvc.perform(get("/")) |.andExpect(status().isFound()).andExpect(redirectedUrl("/account"))
|===

== RefillInventoryControllerTest
// See http://asciidoctor.org/docs/user-manual/#tables
[options="headers"]
|===
||Inventar wird aufgefüllt           |Es soll Benzin nachbestellt werden              |		RequestFuelBody requestFuelBody = new RequestFuelBody();
		requestFuelBody.setAmount(10);
		requestFuelBody.setFuelType(GasPump.DIESEL); |		assertEquals(controller.refillFuels(requestFuelBody), ResponseEntity.ok().build());
|===

== UserManagementControllerTest
// See http://asciidoctor.org/docs/user-manual/#tables
[options="headers"]
|===
||User-Management           | Es soll eine Liste aller User angezeigt werden, welche sich bearbeiten lässt             |mockMvc.perform(get("/user-management")) |.andExpect(status().isOk())
				.andExpect(view().name("user-management"))
				.andExpect(model().attributeExists("customerList"));
||User-Status aktivieren         | Ein Useraccount und seine damit verbundenen Funktionalitäten kann aktiviert werden             |mockMvc.perform(get("/customer/enable")) |				.andExpect(status().isFound());
||User-Status deaktivieren          | Ein Useraccount und seine damit verbundenen Funktionalitäten kann deaktiviert werden             |		mockMvc.perform(get("/customer/disable")) |				.andExpect(status().isFound());
|===

== ItemsControllerTest
// See http://asciidoctor.org/docs/user-manual/#tables
[options="headers"]
|===
||User-Items-Aufruf           |Ein nicht eingeloggter User will auf die Items-Seite zugreifen    |mockMvc.perform(get("/items")) |.andExpect(status().is3xxRedirection())
				.andExpect(redirectedUrl("http://localhost/login"));
||Admin-Items-Aufruf           |Ein als Admin eingeloggter User will auf die Items-Seite zugreifen |mockMvc.perform(get("/items")) |.andExpect(status().is3xxRedirection())
				.andExpect(redirectedUrl("/items-management"));
||Mitarbeiter-Items-Aufruf           | Ein als Mitarbeiter eingeloggter User will auf die Items-Seite zugreifen    |mockMvc.perform(get("/items")) |.andExpect(status().isOk())
				.andExpect(redirectedUrl("/items"));
|| Neues Item          | Es soll ein neues Item zum Catalog hinzugefügt werden             |		mockMvc.perform(get("/newItem"))
 |			.andExpect(status().isFound());
||Item-Details           |Die Details der Zapfsäulen sollen angezeigt werden              |		mockMvc.perform(get("/pump/{number}", 2)) |				.andExpect(status().isFound());
|===

== CustomerUnitTest
// See http://asciidoctor.org/docs/user-manual/#tables
[options="headers"]
|===
||Bestelldatum abrufen |das neueste Bestelldatum eines bestimmten Users soll abgerufen werden |getLastOrderDate() |assertNotNull(testCustomer.getLastOrderDate());
||Bestelldatum festlegen |zu jeder Bestellung soll das entsprechende Datum festgelegt werden |setLastOrderDate()
testCustomer.setLastOrderDate(testDateTime); |    	assertEquals(testCustomer.getLastOrderDate(), testDateTime);
||User-Account abrufen |für jeden User soll der entsprechende User-Account abgerufen werden |getUserAccount() |    	assertEquals(testCustomer.getUserAccount(), testAcc);
||User Full Name abrufen |für jeden User soll der entsprechende vollständige Name abgerufen werden |getFullName() |    	assertEquals(testCustomer.getFullName(), "No Info");
||User-Vorname abrufen |für jeden User soll der entsprechende Vorname abgerufen werden |getFirstName() |    	assertEquals(testCustomer.getFirstname(), "No Info");
||User-Vorname festlegen|zu jedem User soll ein Vorname festgelegt werden |    	testCustomer.setFirstName("test");
|    	assertEquals(testCustomer.getFirstname(), "test");
||User-Nachname abrufen |für jeden User soll der entsprechende Nachname abgerufen werden |getLastName() |    	assertEquals(testCustomer.getLastname(), "No Info");
||User-Nachname festlegen|zu jedem User soll ein Nachname festgelegt werden |    	testCustomer.setLastName("test");
|    	assertEquals(testCustomer.getLastname(), "test");
||User-Emailadresse abrufen |für jeden User soll die entsprechende Email-Adresse abgerufen werden |getEmail() |    	assertNull(testCustomer.getEmail());
||User-Emailadresse festlegen |für jeden User soll eine Email-Adresse festgelegt werden |		testCustomer.setEmail("test@mail.de"); |		assertEquals(testCustomer.getEmail(), "test@mail.de");
||User-Telefonnummer abrufen |für jeden User soll die entsprechende Telefonnummer abgerufen werden |getMobile() |    	assertEquals(testCustomer.getMobile(), "Mobile number");
||User-Telefonnummer festlegen |für jeden User soll eine Telefonnummer festgelegt werden |		testCustomer.setMobile("080032168");|		assertEquals(testCustomer.getMobile(), "080032168");
||User-Kennzeichen abrufen |für jeden User soll das entsprechende Kennzeichen abgerufen werden |getLicensePlate() |		assertNull(testCustomer.getLicensePlate());
||User-Kennzeichen festlegen |für jeden User soll ein Kennzeichen festgelegt werden|		testCustomer.setLicensePlate("DD-Q-12"); | 		assertEquals(testCustomer.getLicensePlate(), "DD-Q-12");
||letzte Useraktivität |Für jeden User soll die Uhrzeit der letzten Aktivität auf der Website geupdated und entsprechend angezeigt werden |		testCustomer.updateLastActivityDate(); |		assertNotNull(testCustomer.getLastActivityDate());
||User-Rabattcodes anzeigen |Ein User kann in seinem Useraccount all seine Rabattcodes einsehen können |getDiscounts() |		assertNull(testCustomer.getDiscounts());
||User-Rabattcodes festlegen |Für einen User wird bei Registrierung (einmalig) und bei der Nutzung eines McPoints ein zufälliger Rabattcode generiert |		testCustomer.setDiscounts(new LinkedList<Discount>()); |assertEquals(testCustomer.getDiscounts(), new LinkedList<Discount>());
		assertTrue(testCustomer.getDiscounts().isEmpty());
||User-Rabattcodes hinzufügen |die generierten Rabattcodes werden dem entsprechenden Useraccount hinzugefügt |		testCustomer.addDiscount(new Discount()); |		assertEquals(testCustomer.getDiscounts().size(), 1);
|===

== DiscountUnitTest
// See http://asciidoctor.org/docs/user-manual/#tables
[options="headers"]
|===
||Rabattcode |Ein Rabattcode soll einen Namen, einen Wert und einen Status bekommen | Discount constructorTest = new Discount("test2", 0.05f); |assertEquals(constructorTest.getName(), "test2");
		assertEquals(constructorTest.getDiscount(), 0.05f);
		assertEquals(constructorTest.getStatus(), Discount.DiscountStatus.AVAILABLE);
||Rabattcode-Abgleich |Jeder Rabattcode darf nur ein einziges mal vorhanden sein |testEquals() |assertTrue(testDiscount.equals(testDiscount));
		assertFalse(testDiscount.equals(new Discount()));
		assertFalse(testDiscount.equals(null));
||Rabattcode-Hashcode |Der HashCode darf nicht null sein |testHashCode() |		assertNotNull(testDiscount.hashCode());
||Rabattcode-ShortId |Die ShortId darf nicht null sein |getShortId() |    	assertNotNull(testDiscount.getShortId());
||Rabattname |Die verschiedenen Rabattereignisse sollen dem Rabattcode angefügt werden und in der Kasse angezeigt werden |getDiscountProductName() |    	assertEquals(testDiscount.getDiscountProductName(), testDiscount.getShortId() + "" + "test");
||Rabattpreis |Jeder Rabattcode soll einen bestimmten Wert bezogen auf das Rabattereignis bekommen |getDiscountPrice() |		assertNotNull(testDiscount.getDiscountPrice(Monetary.getDefaultAmountFactory().setCurrency("EUR").setNumber(10).create()));
||Rabatt-ID abrufen |Für jeden Rabattcode soll dessen ID aberufen werden können |getId() |    	assertNotNull(testDiscount.getId());
||Rabatt-ID festlegen |Jeder Rabattcode soll eine eindeutige Identifikation erhalten|    	testDiscount.setId(UUID.randomUUID()); |testDiscount.setId(UUID.randomUUID());
    	assertNotNull(testDiscount.getId());
||Rabattcode-Status anzeigen |Für jeden Rabattcode soll dessen Status angezeigt werden |getStatus() |    	assertEquals(testDiscount.getStatus(), Discount.DiscountStatus.AVAILABLE);
||Rabattcode-Status festlegen |Für jeden Rabattcode soll dessen Status festgelegt werden |setStatus() | testDiscount.setStatus(Discount.DiscountStatus.EXPIRED);

		assertEquals(testDiscount.getStatus(), Discount.DiscountStatus.EXPIRED);

		testDiscount.setStatus(Discount.DiscountStatus.AVAILABLE);
|=== 

== GasPumpUnitTest
// See http://asciidoctor.org/docs/user-manual/#tables
[options="headers"]
|===
||Zapfsäule-Nummer |Jede Zafpsäule hat eine eigene Nummer, auf die man zugreifen kann |getNumber() |    	assertEquals(testpump.getNumber(), 0);
||Kraftstoff-Typ|Die verschiedenen Typen an Kraftstoff können unterschieden werden |getFuelType() |    	assertNotNull(testpump.getFuelType());
||Kraftstoff-Menge |Man kann auf die Mengen der unterschiedlichen Kraftstoffe zugreifen |getFuelQuantity() |    	assertEquals(testpump.getFuelQuantity(), 0.0f);
|===

== McProductUnitTest
// See http://asciidoctor.org/docs/user-manual/#tables
[options="headers"]
|===
||Produkt-Anzahl |Jedes Produkt wird mit einer bestimmten Anzahl erstellt |getQuantity() |    	assertEquals(testMcProduct.getQuantity(), Quantity.of(10));
||Produkte anzeigen |Jedes Produkt wird im Catalog mit einem bestimmten Namen angezeigt |getProduct() |    	assertEquals(testMcProduct.getProduct(), testProduct);
||Produkt-Bestellung |Für jedes Produkt soll angegeben werden, wie oft es bestellt wurde um die Bestände aktuell zu halten |getOrders()|    	assertEquals(testMcProduct.getOrders(), 10);
|===

== McSitReservationUnitTest
// See http://asciidoctor.org/docs/user-manual/#tables
[options="headers"]
|===
|||||
|||||
|===
